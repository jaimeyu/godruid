  DataCleaningProfileCreateRequest:
    type: "object"
    description: "Object used to create a Data Cleaning Profile in Datahub"
    required: ["data"]
    properties:
      data:
        type: "object"
        required: ["type", "attributes"]
        properties:
          type: 
            type: "string"
            enum: [dataCleaningProfiles]
            default: "dataCleaningProfiles"
          id:
            type: "string"
          attributes:
            type: "object"
            required: ["rules"]
            properties:
              rules:
                type: "array"
                items: 
                  $ref: '#/definitions/DataCleaningRule'
                description: "List of all the rules to evaluate for Data Cleaning"

  DataCleaningProfileUpdateRequest:
    type: "object"
    description: "Object used to update a Data Cleaning Profile in Datahub"
    required: ["data"]
    properties:
      data:
        type: "object"
        required: ["type", "id", "attributes"]
        properties:
          type: 
            type: "string"
            enum: [dataCleaningProfiles]
            default: "dataCleaningProfiles"
          id:
            type: "string"
          attributes:
            type: "object"
            required: ["_rev", "rules"]
            properties:
              _rev:
                type: "string"
                description: "Value used to ensure updates to this object are handled in order."
              rules:
                type: "array"
                items: 
                  $ref: '#/definitions/DataCleaningRule'
                description: "List of all the rules to evaluate for Data Cleaning"

  DataCleaningRule:
    type: "object"
    description: "Provides the logic used to determine when data should be ommitted from queries"
    required: ["metricVendor","metricLabel","triggerCondition","clearCondition"]
    properties:
      metricVendor:
        type: "string"
        description: "The name of the vendor which provides the metric used in the rule."
      metricLabel:
        type: "string"
        description: "The name of the metric used in the rule."
      triggerCondition:
        $ref: '#/definitions/DataCleaningCondition'
        description: "Object which determines when a rule will be triggered/applied"
      clearCondition:
        $ref: '#/definitions/DataCleaningCondition'
        description: "Object which determines when a rule will be cleared"

  DataCleaningCondition:
    type: "object"
    required: ["comparator", "value", "valueAggregate", "duration"]
    description: "A condition used to evalutate when a data cleaning rule should be triggered or cleared."
    properties:
      comparator:
        type: "string"
        enum: [gt,lt,gte,lte,eq]
        description: "Operand to use when evaluating the condition. [gt=greaterThan, lt=lessThan, gte=greaterThanOrEqual, lte=lessThanOrEqual, eq=equal]"
      value:
        type: "string"
        description: "The value against which the selected metric will be compared."
      valueAggregate:
        type: "string"
        enum: [min,max,avg]
        description: "The method of aggregation by which the selected metric will be aggregateds. [min=minimum, max=maximum, avg=average]"
      duration: 
        type: "string"
        description: "ISO-8601 interval over which this codition will be evaluated."

  DataCleaningProfileResponse:
    type: "object"
    description: "A single object Data Cleaning Profile response from Datahub"
    required: ["data"]
    properties:
      data:
        $ref: '#/definitions/DataCleaningProfile'
  
  DataCleaningProfileListResponse:
    type: "object"
    description: "Response for one ore more Data Cleaning Profiles from Datahub"
    required: ["data"]
    properties:
      data:
        type: "array"
        items:
          $ref: '#/definitions/DataCleaningProfile'

  DataCleaningProfile:
    type: "object"
    required: ["type", "id", "attributes"]
    properties:
      type: 
        type: "string"
        enum: [dataCleaningProfiles]
        default: "dataCleaningProfiles"
      id:
        type: "string"
      attributes:
        type: "object"
        required: ["_rev", "rules", "createdTimestamp", "lastModifiedTimestamp"]
        properties:
          _rev:
            type: "string"
            description: "Value used to ensure updates to this object are handled in order."
          rules:
            type: "array"
            items: 
              $ref: '#/definitions/DataCleaningRule'
            description: "List of all the rules to evaluate for Data Cleaning"
          createdTimestamp:
            type: "integer"
            format: "int64"
            description: "Time since epoch at which this object was instantiated."
          lastModifiedTimestamp:
            type: "integer"
            format: "int64"
            description: "Time since epoch at which this object was last altered."
            
  DataCleaningHistoryResponse:
    type: "object"
    required: ["data"]
    properties:
      data:
        $ref: '#/definitions/DataCleaningHistory'
  
  DataCleaningHistory:
    type: "object"
    required: ["type", "id", "attributes"]
    properties:
      type: 
        type: "string"
        enum: [dataCleaningHistory]
        default: "dataCleaningHistory"
      id:
        type: "string"
      attributes:  
        type: "object"
        required: ["events"]
        properties:
          transitions:
            type: "array"
            items: 
              $ref: '#/definitions/DataCleaningTransition'
            description: "List of data cleaning events"

  DataCleaningTransition:
    type: object
    properties:
      timestamp:
        type: "integer"
        format: "int64"
        description: "Time since epoch at which these transitions occurred."
      rulesRaised:
        type: array
        items:
          $ref: '#/definitions/DataCleaningTransitionRule'
      rulesCleared:
        type: array
        items:
          $ref: '#/definitions/DataCleaningTransitionRule'
      errorsRaised:
        type: array
        items:
          $ref: '#/definitions/DataCleaningTransitionError'
      errorsCleared:
        type: array
        items:
          $ref: '#/definitions/DataCleaningTransitionError'

  DataCleaningTransitionRule:
    type: object
    properties:
      direction:
        type: string
      rule:
        $ref: '#/definitions/DataCleaningRule'

  DataCleaningTransitionError:
    type: object
    properties:
      direction:
        type: string
      errorCode:
        type: string
